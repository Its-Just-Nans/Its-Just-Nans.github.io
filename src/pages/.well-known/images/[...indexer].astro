---
import { join, relative } from "path";
import AstroIndex, { walkDirs } from "astro-index";
const folder = ".well-known/images";

const baseToRender = join(process.cwd(), "public", folder);

export async function getStaticPaths() {
    const folder = ".well-known/images";
    const baseToRender = join(process.cwd(), "public", folder);
    const dirs = walkDirs(baseToRender);

    const paths = dirs.map((full) => {
        const p = relative(baseToRender, full);
        const pFilter = p === "" ? undefined : p;
        return {
            params: { indexer: pFilter },
        };
    });
    return paths;
}
const { indexer } = Astro.params;
const pathIndex = indexer ?? "/";
const pathExpose = join(baseToRender, pathIndex);
const titlePath = pathExpose.replace(baseToRender, "").substring(1);
---

<AstroIndex
    recursiveBase={baseToRender}
    path={pathExpose}
    title={folder}
    preview
    previewUrl={`/${folder}/`}
    title={`${folder}/${titlePath}`}
    pixelated={true}
/>
