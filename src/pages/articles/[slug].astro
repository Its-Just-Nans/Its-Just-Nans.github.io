---
import ArticleView from "../../components/ArticleView.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import "../../styles/markdown.css";

const { post } = Astro.props;
const { Content } = post;

export async function getStaticPaths() {
    const posts = await Astro.glob("/data/articles/*.mdx");
    const nonDraftPosts = import.meta.env.DEV ? posts : posts.filter((post) => !post.frontmatter.draft);
    const params = nonDraftPosts.map((onePost) => ({
        params: { slug: onePost.url.split("/").pop().split(".").shift() },
        props: { post: onePost },
    }));
    return params;
}
---

<BaseLayout>
    <ArticleView title={post.frontmatter.title} date={post.frontmatter.date} draft={post.frontmatter.draft}>
        <Content />
    </ArticleView>
</BaseLayout>
